<% layout("/mentee/layouts/boilerplate") -%>
<div class="container mt-4">
    <h1>Find a Mentor</h1>
    <div class="row">
        <% mentors.forEach(mentor => { %>
        <div class="col-md-4 mb-4">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title"><%= mentor.user.username %></h5>
                    <p><strong>Expertise:</strong> <%= mentor.expertise.join(', ') %></p>
                    <p><strong>Experience:</strong> <%= mentor.yearsOfExperience %> years</p>
                    <p><%= mentor.bio %></p>
                    <button class="btn btn-primary send-request-btn" data-id="<%= mentor._id %>">
                        Send Connect Request
                    </button>
                </div>
            </div>
        </div>
        <% }) %>
    </div>
</div>
<script>
    document.querySelectorAll(".send-request-btn").forEach(button => {
        button.addEventListener("click", function () {
            const mentorId = this.dataset.id;
            fetch("/connections/send-request", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ mentorId }),
            })
                .then(res => res.json())
                .then(data => {
                    alert(data.message);
                })
                .catch(err => console.error(err));
        });
    });
</script>
<%- include('layouts/footer') %>
