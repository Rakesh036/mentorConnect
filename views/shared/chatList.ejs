<%- layout("/shared/layout", { cssFile: "chat2.css" }) -%>
<div class="container mt-4">
    <h1>Your Chats</h1>
    <a href="/mentor" class="btn btn-secondary mb-3">Back to Dashboard</a>

    <% if (chats.length === 0) { %>
        <p class="text-muted">You have no chats. Start a conversation!</p>
    <% } else { %>
        <ul class="list-group">
            <% chats.forEach(chat => { %>
                <li class="list-group-item d-flex justify-content-between align-items-center">
                    <div>
                        <strong><%= chat.participants.find(p => p._id != userId).username %></strong>
                        <small class="text-muted d-block">
                            Last message: <%= chat.messages.length ? chat.messages[chat.messages.length - 1].text : 'No messages yet.' %>
                        </small>
                    </div>
                    <a href="/chat/<%= chat._id %>" class="btn btn-primary btn-sm">Open Chat</a>
                </li>
            <% }) %>
        </ul>
    <% } %>
</div>
